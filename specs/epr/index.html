<!doctype html>
<html lang="en">
 <head>
  
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  
  
  <title>Entry Point Regulation</title>
  
  
  <link href="../default.css" rel="stylesheet" type="text/css">
  
  
  <style>
  body {
    background: url("https://www.w3.org/StyleSheets/TR/logo-ED") top left no-repeat white;
    background-attachment: fixed;
    color: black;
    font-family: sans-serif;
    margin: 0 auto;
    max-width: 50em;
    padding: 2em 1em 2em 70px;
  }
  :link { color: #00C; background: transparent }
  :visited { color: #609; background: transparent }
  a[href]:active { color: #C00; background: transparent }
  a[href]:hover { background: #ffa }

  a[href] img { border-style: none }

  h1, h2, h3, h4, h5, h6 { text-align: left }
  h1, h2, h3 { color: #005A9C; }
  h1 { font: 170% sans-serif }
  h2 { font: 140% sans-serif }
  h3 { font: 120% sans-serif }
  h4 { font: bold 100% sans-serif }
  h5 { font: italic 100% sans-serif }
  h6 { font: small-caps 100% sans-serif }

  .hide { display: none }

  div.head { margin-bottom: 1em }
  div.head h1 { margin-top: 2em; clear: both }
  div.head table { margin-left: 2em; margin-top: 2em }

  p.copyright { font-size: small }
  p.copyright small { font-size: small }

  pre { margin-left: 2em }
  dt { font-weight: bold }

  ul.toc, ol.toc {
    list-style: none;
  }
  </style>
  

  <meta content="Bikeshed 1.0.0" name="generator">
 </head>
 

 <body class="h-entry">

  <div class="head">
  
   <p data-fill-with="logo"><a class="logo" href="http://www.w3.org/">
    <img alt="W3C" height="48" src="https://www.w3.org/Icons/w3c_home" width="72">
</a>
</p>
  
   <h1 class="p-name no-ref" id="title">Entry Point Regulation</h1>
  
   <h2 class="no-num no-toc no-ref heading settled" id="subtitle"><span class="content">Editor’s Draft,
    <time class="dt-updated" datetime="2015-04-02">2 April 2015</time></span></h2>
  
   <div data-fill-with="spec-metadata">
    <dl>
     <dt>This version:
     <dd><a class="u-url" href="https://w3c.github.io/webappsec/specs/epr/">https://w3c.github.io/webappsec/specs/epr/</a>
     <dt>Feedback:
     <dd><span><a href="mailto:public-webappsec@w3.org?subject=%5BEPR%5D%20feedback">public-webappsec@w3.org</a> with subject line “<kbd>[EPR] <var>… message topic …</var></kbd>” (<a href="http://lists.w3.org/Archives/Public/public-webappsec/" rel="discussion">archives</a>)</span>
     <dt>Issue Tracking:
     <dd><a href="#issues-index">Inline In Spec</a>
     <dt class="editor">Editors:
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:drx@google.com">David Ross</a> (<span class="p-org org">Google Inc.</span>)
     <dd class="editor p-author h-card vcard" data-editor-id="56384"><a class="p-name fn u-email email" href="mailto:mkwst@google.com">Mike West</a> (<span class="p-org org">Google Inc.</span>)
    </dl>
   </div>
  
   <div data-fill-with="warning"></div>
  
   <p class="copyright" data-fill-with="copyright"><a href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> © 2015 <a href="http://www.w3.org/"><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>®</sup> (<a href="http://www.csail.mit.edu/"><abbr title="Massachusetts Institute of Technology">MIT</abbr></a>, <a href="http://www.ercim.eu/"><abbr title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>, <a href="http://www.keio.ac.jp/">Keio</a>, <a href="http://ev.buaa.edu.cn/">Beihang</a>). W3C <a href="http://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>, <a href="http://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and <a href="http://www.w3.org/Consortium/Legal/copyright-documents">document use</a> rules apply.
</p>
  
   <hr title="Separator for header">
</div>


  <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>

  <div class="p-summary" data-fill-with="abstract">
   <p>This document allows authors to mitigate the risk of certain kinds of

cross-site scripting (XSS) and cross-site request forgery (XSRF) attacks
by defining a mechanism which an author can use to assert restrictions upon
the ways in which resources may be fetched from an origin.</p>

</div>


  <h2 class="no-num no-toc no-ref heading settled" id="status"><span class="content">Status of this document</span></h2>

  <div data-fill-with="status">
   <p>
	This is a public copy of the editors’ draft.
	It is provided for discussion only and may change at any moment.
	Its publication here does not imply endorsement of its contents by W3C.
	Don’t cite this document other than as work in progress.

</p>
   <p>
  <strong>Changes to this document may be tracked at
  <a href="https://github.com/w3c/webappsec">https://github.com/w3c/webappsec</a>.</strong>

</p>
   <p>
	The (<a href="http://lists.w3.org/Archives/Public/public-webappsec/">archived</a>) public mailing list
	<a href="mailto:public-webappsec@w3.org?Subject=%5BEPR%5D%20PUT%20SUBJECT%20HERE">public-webappsec@w3.org</a>
	(see <a href="http://www.w3.org/Mail/Request">instructions</a>)
	is preferred for discussion of this specification.
	When sending e-mail,
	please put the text “EPR” in the subject,
	preferably like this:
	“[EPR] <em>…summary of comment…</em>”

</p>
   <p>
	This document was produced by the
  <a href="http://www.w3.org/2011/webappsec/">Web Application Security Working Group</a>.

</p>
   <p>
	This document was produced by a group operating under
	the <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/">5 February 2004 W3C Patent Policy</a>.
	W3C maintains a <a href="http://www.w3.org/2004/01/pp-impl/49309/status" rel="disclosure">public list of any patent disclosures</a>
	made in connection with the deliverables of the group;
	that page also includes instructions for disclosing a patent.
	An individual who has actual knowledge of a patent which the individual believes contains <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#def-essential">Essential Claim(s)</a>
	must disclose the information in accordance with <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#sec-Disclosure">section 6 of the W3C Patent Policy</a>.

</p>
   <p>
  This document is governed by the <a href="http://www.w3.org/2014/Process-20140801/" id="w3c_process_revision">1 August 2014 W3C Process Document</a>.

</p></div>

  <div data-fill-with="at-risk"></div>


  <h2 class="no-num no-toc no-ref heading settled" id="contents"><span class="content">Table of Contents</span></h2>

  <div data-fill-with="table-of-contents" role="navigation">
   <ul class="toc" role="directory">
    <li><a href="#intro"><span class="secno">1</span> <span class="content">Introduction</span></a>
     <ul class="toc">
      <li><a href="#goals"><span class="secno">1.1</span> <span class="content">Goals</span></a>
      <li><a href="#examples"><span class="secno">1.2</span> <span class="content">Examples</span></a>
     </ul>
    <li><a href="#key-concepts"><span class="secno">2</span> <span class="content">Key Concepts and Terminology</span></a>
    <li><a href="#delivery"><span class="secno">3</span> <span class="content">Delivery</span></a>
     <ul class="toc">
      <li><a href="#epr-header"><span class="secno">3.1</span> <span class="content">The <code>EPR</code> HTTP Response Header Field</span></a>
      <li><a href="#manifest"><span class="secno">3.2</span> <span class="content">Manifest</span></a>
       <ul class="toc">
        <li><a href="#manifest-rulesets"><span class="secno">3.2.1</span> <span class="content">Rulesets</span></a>
       </ul>
     </ul>
    <li><a href="#algorithms"><span class="secno">4</span> <span class="content">Processing Algorithms</span></a>
     <ul class="toc">
      <li><a href="#process-request"><span class="secno">4.1</span> <span class="content">
    Process <var>request</var>
  </span></a>
      <li><a href="#process-epr-header"><span class="secno">4.2</span> <span class="content">
    Process <var>response</var>’s <code>EPR</code> header
  </span></a>
      <li><a href="#matching"><span class="secno">4.3</span> <span class="content">
    Does <var>request</var> match <var>rule</var>?
  </span></a>
     </ul>
    <li><a href="#iana-considerations"><span class="secno">5</span> <span class="content">IANA Considerations</span></a>
     <ul class="toc">
      <li><a href="#iana-https"><span class="secno">5.1</span> <span class="content">
    The <code>EPR</code> HTTP Request Header Field
  </span></a>
      <li><a href="#iana-well-known"><span class="secno">5.2</span> <span class="content">
    The Well-Known EPR Manifest URI
  </span></a>
     </ul>
    <li><a href="#acknowledgements"><span class="secno">6</span> <span class="content">Acknowledgements</span></a>
    <li><a href="#conformance"><span class="secno"></span> <span class="content">Conformance</span></a>
     <ul class="toc">
      <li><a href="#conventions"><span class="secno"></span> <span class="content">Document conventions</span></a>
      <li><a href="#conformant-algorithms"><span class="secno"></span> <span class="content">Conformant Algorithms</span></a>
      <li><a href="#conformance-classes"><span class="secno"></span> <span class="content">Conformance Classes</span></a>
     </ul>
    <li><a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ul class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
      <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms defined by reference</span></a>
     </ul>
    <li><a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ul class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
      <li><a href="#informative"><span class="secno"></span> <span class="content">Informative References</span></a>
     </ul>
    <li><a href="#idl-index"><span class="secno"></span> <span class="content">IDL Index</span></a>
    <li><a href="#issues-index"><span class="secno"></span> <span class="content">Issues Index</span></a>
   </ul></div>

  <main>









   <section>
  
    <h2 class="heading settled" data-level="1" id="intro"><span class="secno">1. </span><span class="content">Introduction</span><a class="self-link" href="#intro"></a></h2>


    <p><em>This section is not normative.</em></p>


    <p>EPR provides a browser-enforced mechanism for validating an entry point
  policy supplied with a web application.  External references and navigations
  to non-entry points can then be restricted based on this policy.</p>


    <p>Entry point regulation may be considered an implementation of concepts
  introduced by Charlie Reis et al. in <a data-link-type="biblio" href="#biblio-isolation">[ISOLATION]</a>.</p>

  
    <h3 class="heading settled" data-level="1.1" id="goals"><span class="secno">1.1. </span><span class="content">Goals</span><a class="self-link" href="#goals"></a></h3>


    <p>TBD.</p>

  
    <h3 class="heading settled" data-level="1.2" id="examples"><span class="secno">1.2. </span><span class="content">Examples</span><a class="self-link" href="#examples"></a></h3>


    <p>TBD.</p>
</section>



   <section>
  
    <h2 class="heading settled" data-level="2" id="key-concepts"><span class="secno">2. </span><span class="content">Key Concepts and Terminology</span><a class="self-link" href="#key-concepts"></a></h2>


    <p>The Augmented Backus-Naur Form (ABNF) notation is specified in RFC5234
  <a data-link-type="biblio" href="#biblio-abnf">[ABNF]</a>.</p>
</section>



   <section>
  
    <h2 class="heading settled" data-level="3" id="delivery"><span class="secno">3. </span><span class="content">Delivery</span><a class="self-link" href="#delivery"></a></h2>

  
    <h3 class="heading settled" data-level="3.1" id="epr-header"><span class="secno">3.1. </span><span class="content">The <code>EPR</code> HTTP Response Header Field</span><a class="self-link" href="#epr-header"></a></h3>


    <p>Servers may request the protections outlined in this document by sending an
  <dfn data-dfn-type="dfn" data-local-lt="EPR" data-noexport="" id="epr-http-response-header-field"><code>EPR</code> HTTP response header field<a class="self-link" href="#epr-http-response-header-field"></a></dfn> along
  with a response. This request is represented by the following ABNF:</p>

  
    <pre>"EPR:" *<a data-link-type="dfn" href="https://tools.ietf.org/html/rfc5234#appendix-B.1">WSP</a> "1" *<a data-link-type="dfn" href="https://tools.ietf.org/html/rfc5234#appendix-B.1">WSP</a>
</pre>


    <p>User agent conformance details upon receipt of such a header are explained in
  <a href="#process-epr-header">§4.2 
    Process response’s EPR header
  </a>.</p>

  
    <h3 class="heading settled" data-level="3.2" id="manifest"><span class="secno">3.2. </span><span class="content">Manifest</span><a class="self-link" href="#manifest"></a></h3>


    <p>An <dfn data-dfn-type="dfn" data-noexport="" id="epr-manifest">EPR manifest<a class="self-link" href="#epr-manifest"></a></dfn> is a JSON file containing entry point regulation
  policy data for an <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc6454#section-3.2">origin</a>.</p>


    <p>Servers which opt-in to EPR protections via the <code><a data-link-type="dfn" href="#epr-http-response-header-field">EPR</a></code> header
  MUST make a manifest file available at
  "<code>/.well-known/epr-manifest.json</code>".</p>


    <p class="issue" id="issue-3b30c111"><a class="self-link" href="#issue-3b30c111"></a>Why is this distinct from <a data-link-type="biblio" href="#biblio-manifest">[MANIFEST]</a>? I think we could do pretty
  much everything by adding an <code>erp_rules</code> attribute. Since we’ve
  already accepted the asynchronocity, duplicating the manifest doesn’t seem
  prudent.</p>

  
    <div class="example">
    
     <pre>{
  "site": "https://example.com/",
  "maxAge": 31536000,
  "reportUrl": "https://example.com/reporting-endpoint",
  "defaultNavBehavior": "block",
  "defaultResBehavior": "block",
  "rules": [
    {
      "path": "/",
      "types": [ "navigation" ],
      "allowData": false
    },
    {
      "regex": "^/\\d+$",
      "types": [ "navigation" ],
      "allowData": false
    },
    ...
    {
      "path": "/image",
      "types": [ "image" ],
      "allowData": true
    },
  ]
}
</pre>
     


     <p class="issue" id="issue-6332bbe9"><a class="self-link" href="#issue-6332bbe9"></a>The example manifest defines <code>site</code>. Do we really need
    that, given that we know the manifest’s URL?</p>
     


     <p class="issue" id="issue-1122723a"><a class="self-link" href="#issue-1122723a"></a>The example manifest defines <code>maxAge</code>. Do we need that,
    or can we rely on cache headers?</p>
     


     <p class="issue" id="issue-2a78bb3d"><a class="self-link" href="#issue-2a78bb3d"></a>The example manifest defines <code>reportUrl</code>. What does this
    report? What do the reports look like? Do we need it at all?</p>
     


     <p class="issue" id="issue-ef156df8"><a class="self-link" href="#issue-ef156df8"></a>The example manifest defines <code>defaultNavBehavior</code>. What
    does this do?</p>
     


     <p class="issue" id="issue-28b78586"><a class="self-link" href="#issue-28b78586"></a>The example manifest defines <code>defaultResBehavior</code>. What
    does this do?</p>
     
  
    </div>

  
    <h4 class="heading settled" data-level="3.2.1" id="manifest-rulesets"><span class="secno">3.2.1. </span><span class="content">Rulesets</span><a class="self-link" href="#manifest-rulesets"></a></h4>


    <p>EPR manifests define a set of <dfn data-dfn-type="dfn" data-noexport="" id="rules">rules<a class="self-link" href="#rules"></a></dfn> for a site, governing a user
  agent’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#fetching">fetching</a> behavior for <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">requests</a> made to that site’s
  <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc6454#section-3.2">origin</a>. Each rule is scoped to a specific subset of an origin’s
  URLs via a path prefix or a regular expression, and contains a set of
  behaviors which MUST be applied to <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">requests</a> which match the rule’s
  scope (as defined in <a href="#matching">§4.3 
    Does request match rule?
  </a>).</p>


    <p>The following IDL defines rules' syntax:</p>

  
    <pre class="idl">enum <dfn class="idl-code" data-dfn-type="enum" data-export="" data-global-name="" id="enumdef-requestcontext">RequestContext<a class="self-link" href="#enumdef-requestcontext"></a></dfn> {
    "audio", "beacon", "cspreport", "download", "embed", "eventsource",
    "favicon", "fetch", "font", "form", "frame", "hyperlink", "iframe",
    "image", "imageset", "import", "internal", "location", "manifest",
    "metarefresh", "object", "ping", "plugin", "prefetch", "script",
    "serviceworker", "sharedworker", "subresource", "style", "track",
    "video", "worker", "xmlhttprequest", "xslt"
};

enum <dfn class="idl-code" data-dfn-type="enum" data-export="" data-global-name="" id="enumdef-requestframetype">RequestFrameType<a class="self-link" href="#enumdef-requestframetype"></a></dfn> {
  "auxiliary", "nested", "none", "top-level"
};

dictionary <dfn class="idl-code" data-dfn-type="dictionary" data-export="" data-global-name="" id="dictdef-eprrule">EPRRule<a class="self-link" href="#dictdef-eprrule"></a></dfn> {
  USVString? <a class="idl-code" data-global-name="EPRRule<dictionary>/path<dict-member>" data-link-type="dict-member" data-type="USVString? " href="#dom-eprrule-path">path</a>;
  USVString? <a class="idl-code" data-global-name="EPRRule<dictionary>/regex<dict-member>" data-link-type="dict-member" data-type="USVString? " href="#dom-eprrule-regex">regex</a>;
  sequence&lt;<a data-link-type="idl-name" href="#enumdef-requestcontext">RequestContext</a>> <a class="idl-code" data-global-name="EPRRule<dictionary>/contexts<dict-member>" data-link-type="dict-member" data-type="sequence<RequestContext> " href="#dom-eprrule-contexts">contexts</a>;
  sequence&lt;<a data-link-type="idl-name" href="#enumdef-requestframetype">RequestFrameType</a>> <a class="idl-code" data-global-name="EPRRule<dictionary>/frameTypes<dict-member>" data-link-type="dict-member" data-type="sequence<RequestFrameType> " href="#dom-eprrule-frametypes">frameTypes</a>;
  boolean <a class="idl-code" data-global-name="EPRRule<dictionary>/allowData<dict-member>" data-link-type="dict-member" data-type="boolean " href="#dom-eprrule-allowdata">allowData</a>;
};
</pre>
  
    <dl>
    
     <dt><dfn class="idl-code" data-dfn-for="EPRRule" data-dfn-type="dict-member" data-export="" id="dom-eprrule-path">path<a class="self-link" href="#dom-eprrule-path"></a></dfn>, <span> of type <a data-link-type="idl-name" href="https://heycam.github.io/webidl/#idl-USVString">USVString</a>, nullable</span>
     
    
     <dd>
      A path prefix defining a <a data-link-type="dfn" href="#rules">rule</a>’s scope. See <a href="#matching">§4.3 
    Does request match rule?
  </a> for user
      agent conformance requirements.


      <p class="issue" id="issue-b0f6b6d6"><a class="self-link" href="#issue-b0f6b6d6"></a>When do we <a data-link-type="dfn" href="http://www.w3.org/TR/url/#percent-decode">percent decode</a>?</p>
      
    
     
    
     <dt><dfn class="idl-code" data-dfn-for="EPRRule" data-dfn-type="dict-member" data-export="" id="dom-eprrule-regex">regex<a class="self-link" href="#dom-eprrule-regex"></a></dfn>, <span> of type <a data-link-type="idl-name" href="https://heycam.github.io/webidl/#idl-USVString">USVString</a>, nullable</span>
     
    
     <dd>
      A regular expression, defining a <a data-link-type="dfn" href="#rules">rule</a>’s scope. See <a href="#matching">§4.3 
    Does request match rule?
  </a>
      for user agent conformance requirements.
    
     
    
     <dt><dfn class="idl-code" data-dfn-for="EPRRule" data-dfn-type="dict-member" data-export="" id="dom-eprrule-contexts">contexts<a class="self-link" href="#dom-eprrule-contexts"></a></dfn>, <span> of type sequence&lt;<a data-link-type="idl-name" href="#enumdef-requestcontext">RequestContext</a>></span>
     
    
     <dd>
      A set of <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-context">contexts</a> to which this rule applies. See
      <a href="#matching">§4.3 
    Does request match rule?
  </a> for user agent conformance requirements.
    
     
    
     <dt><dfn class="idl-code" data-dfn-for="EPRRule" data-dfn-type="dict-member" data-export="" id="dom-eprrule-frametypes">frameTypes<a class="self-link" href="#dom-eprrule-frametypes"></a></dfn>, <span> of type sequence&lt;<a data-link-type="idl-name" href="#enumdef-requestframetype">RequestFrameType</a>></span>
     
    
     <dd>
      A set of <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-context-frame-type">context frame types</a> to which this rule
      applies. See <a href="#matching">§4.3 
    Does request match rule?
  </a> for user agent conformance requirements.
    
     
    
     <dt><dfn class="idl-code" data-dfn-for="EPRRule" data-dfn-type="dict-member" data-export="" id="dom-eprrule-allowdata">allowData<a class="self-link" href="#dom-eprrule-allowdata"></a></dfn>, <span> of type <a data-link-type="idl-name" href="https://heycam.github.io/webidl/#idl-boolean">boolean</a></span>
     
    
     <dd>
      If <code>true</code>, then matching <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">requests</a>'
      <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-url">URL</a>s are allowed to contain non-empty
      <a data-link-type="dfn" href="http://www.w3.org/TR/url/#concept-url-query">query</a> and <a data-link-type="dfn" href="http://www.w3.org/TR/url/#concept-url-fragment">fragment</a> properties,
      and <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">requests</a>' <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-body">body</a> may be non-null.


      <p>See <a href="#process-request">§4.1 
    Process request
  </a> for user agent conformance requirements.</p>
      
    
     
  
    </dl>
</section>



   <section>
  
    <h2 class="heading settled" data-level="4" id="algorithms"><span class="secno">4. </span><span class="content">Processing Algorithms</span><a class="self-link" href="#algorithms"></a></h2>

  
    <h3 class="heading settled" data-level="4.1" id="process-request"><span class="secno">4.1. </span><span class="content">
    Process <var>request</var>
  </span><a class="self-link" href="#process-request"></a></h3>

  
    <ol>
    
     <li>
      Let <var>rules</var> be the <a data-link-type="dfn" href="#rules">rules</a> which a user agent has stored
      for <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-url">URL</a>’s <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc6454#section-3.2">origin</a>.
    
     
    
     <li>
      For each <var>rule</var> in <var>rules</var>, if <var>request</var>
      <a data-link-type="dfn" href="#match">matches</a> <var>rule</var>:

      
      <ol>
        
       <li>TODO
       
      
      </ol>
      
    
     
  
    </ol>

  
    <h3 class="heading settled" data-level="4.2" id="process-epr-header"><span class="secno">4.2. </span><span class="content">
    Process <var>response</var>’s <code>EPR</code> header
  </span><a class="self-link" href="#process-epr-header"></a></h3>


    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response">response</a> (<var>response</var>), this algorithm parses its
  <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-header-list">header list</a> to extract an <code><a data-link-type="dfn" href="#epr-http-response-header-field">EPR</a></code>
  header field. If such a field is present, the user agent MUST fetch and
  process an <a data-link-type="dfn" href="#epr-manifest">EPR manifest</a> from <var>response</var>’s <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc6454#section-3.2">origin</a>.</p>


    <p>To <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#process-response">process response</a> <var>response</var>, execute the following steps:</p>

  
    <ol>
    
     <li>
      ISSUE: Do we process a header for any response? Only responses to
      top-level requests?
    
     
    
     <li>
      If <var>response</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-url">URL</a> is <a data-link-type="dfn" href="https://w3c.github.io/webappsec/specs/mixedcontent/#a-priori-insecure-url"><i lang="la">a
      priori</i> insecure</a>, abort these steps.
    
     
    
     <li>
      If <var>response</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-header-list">header list</a> contains a
      <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header">header</a> named <code><a data-link-type="dfn" href="#epr-http-response-header-field">EPR</a></code>, then:

      
      <ol>
        
       <li>
          Let <var>manifest URL</var> be the result of executing the <a data-link-type="dfn" href="http://www.w3.org/TR/url/#concept-url-parser">URL
          parser</a> on "<code>/.well-known/epr-manifest.json</code>", with
          a <a data-link-type="dfn" href="http://www.w3.org/TR/url/#concept-base-url">base URL</a> of <var>response</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-url">URL</a>.
        
       
        
       <li>
          Let <var>request</var> be a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">request</a> whose
          <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-method">method</a> is <code>GET</code>,
          <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-url">URL</a> is <var>manifest URL</var>,
          <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-context-frame-type">context frame type</a> is <code>none</code>,
          <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-context">context</a> is <code>manifest</code>, and
          <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-client">credentials</a> is <code>omit</code>.


        <p class="issue" id="issue-f19006b1"><a class="self-link" href="#issue-f19006b1"></a>Is there a use case for delivering different manifests to
          different users? I’d hope not.</p>
        
        
       
        
       <li>
          <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#fetching">Fetch</a> <var>request</var>.
        
       
        
       <li>
          To <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#process-response">process response</a> for the <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response">response</a> <var>manifest
          response</var>:

          
        <ol>
            
         <li>
              TODO.
            
         
          
        </ol>
        
        
       
      
      </ol>
      
    
     
  
    </ol>

  
    <h3 class="heading settled" data-level="4.3" id="matching"><span class="secno">4.3. </span><span class="content">
    Does <var>request</var> match <var>rule</var>?
  </span><a class="self-link" href="#matching"></a></h3>


    <p>A <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request">request</a> (<var>request</var>) is said to <dfn data-dfn-type="dfn" data-noexport="" id="match">match<a class="self-link" href="#match"></a></dfn> a
  <a data-link-type="dfn" href="#rules">rule</a> (<var>rule</var>) if the following algorithm returns
  <code>Matches</code>:</p>

  
    <ol>
    
     <li>
      If <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-context">context</a> is not in
      <var>rule</var>’s <code class="idl"><a data-link-type="idl" href="#dom-eprrule-contexts">contexts</a></code> list, return <code>Does Not
      Match</code>.
    
     
    
     <li>
      If <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-context-frame-type">context frame type</a> is not in
      <var>rule</var>’s <code class="idl"><a data-link-type="idl" href="#dom-eprrule-frametypes">frameTypes</a></code> list, return <code>Does Not
      Match</code>.
    
     
    
     <li>
      If <var>rule</var> has a <code class="idl"><a data-link-type="idl" href="#dom-eprrule-path">path</a></code> property whose value is
      neither <code>null</code> nor <code>undefined</code>:

      
      <ol>
        
       <li>
          Let <var>rule path</var> be <var>rule</var>’s <code class="idl"><a data-link-type="idl" href="#dom-eprrule-path">path</a></code>.
        
       
        
       <li>
          Let <var>exact match</var> be <code>false</code> if the final
          character of <var>rule path</var> is the U+002F SOLIDUS character
          (<code>/</code>), and <code>true</code> otherwise.
        
       
        
       <li>
          Let <var>rule path list</var> be the result of splitting <var>rule
          path</var> on the U+002F SOLIDUS character (<code>/</code>).
        
       
        
       <li>
          If <var>rule path list</var>’s length is greater than <var>url
          path list</var>’s length, return <code>Does Not Match</code>.
        
       
        
       <li>
          For each <var>entry</var> in <var>rule path list</var>:

          
        <ol>
            
         <li>
              <a data-link-type="dfn" href="http://www.w3.org/TR/url/#percent-decode">Percent decode</a> <var>entry</var>.
            
         
            
         <li>
              <a data-link-type="dfn" href="http://www.w3.org/TR/url/#percent-decode">Percent decode</a> the first item in <var>url path list</var>.
            
         
            
         <li>
              If <var>entry</var> is not an <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#ascii-case-insensitive">ASCII case-insensitive
              match</a> for the first item in <var>url path list</var>, return
              <code>Does Not Match</code>
            
         
            
         <li>
              Pop the first item in <var>url path list</var> off the list.
            
         
          
        </ol>
        
        
       
        
       <li>
          If <var>exact match</var> is <code>true</code>, and <var>url path
          list</var> is not empty, return <code>Does Not Match</code>
        
       
      
      </ol>
      
    
     
    
     <li>
      If <var>rule</var> has a <code class="idl"><a data-link-type="idl" href="#dom-eprrule-regex">regex</a></code> property whose value is
      neither <code>null</code> nor <code>undefined</code>:

      
      <ol>
        
       <li>
          Let <var>rule regex</var> be <var>rule</var>’s <code class="idl"><a data-link-type="idl" href="#dom-eprrule-regex">regex</a></code>.
        
       
        
       <li>
          Let <var>url path</var> be the empty string, and for each
          <var>component</var> in <var>request</var>’s
          <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-url">URL</a>’s <a data-link-type="dfn" href="http://www.w3.org/TR/url/#concept-url-path">path</a>:

          
        <ol>
            
         <li>
              Append the U+002F SOLIDUS character (<code>/</code>) to
              <var>url path</var>.
            
         
            
         <li>
              Append <var>component</var> to <var>url path</var>.
            
         
          
        </ol>
        
        
       
        
       <li>
          If <var>url path</var> does not <em>regex match</em> (TODO) <var>rule
          regex</var>, return <code>Does Not Match</code>.


        <p class="issue" id="issue-e1f6f36f"><a class="self-link" href="#issue-e1f6f36f"></a>Need to have spec language for this. There’s surely a regex
          spec somewhere, right?</p>
        
        
       
      
      </ol>
      
    
     
    
     <li>
      Return <code>Matches</code>.
    
     
  
    </ol>
</section>



   <section>
  
    <h2 class="heading settled" data-level="5" id="iana-considerations"><span class="secno">5. </span><span class="content">IANA Considerations</span><a class="self-link" href="#iana-considerations"></a></h2>

  
    <h3 class="heading settled" data-level="5.1" id="iana-https"><span class="secno">5.1. </span><span class="content">
    The <code>EPR</code> HTTP Request Header Field
  </span><a class="self-link" href="#iana-https"></a></h3>
  The permanent message header field registry should be updated with the
  following registration <a data-link-type="biblio" href="#biblio-rfc3864">[RFC3864]</a>:

  
    <dl>
    
     <dt>Header field name
     
    
     <dd>EPR
     

    
     <dt>Applicable protocol
     
    
     <dd>http
     

    
     <dt>Status
     
    
     <dd>standard
     

    
     <dt>Author/Change controller
     
    
     <dd>W3C
     

    
     <dt>Specification document
     
    
     <dd>This specification (See <a href="#epr-header">§3.1 The EPR HTTP Response Header Field</a>)
     
  
    </dl>

  
    <h3 class="heading settled" data-level="5.2" id="iana-well-known"><span class="secno">5.2. </span><span class="content">
    The Well-Known EPR Manifest URI
  </span><a class="self-link" href="#iana-well-known"></a></h3>


    <p>The well-known URI registry should be updated with the following
  registration <a data-link-type="biblio" href="#biblio-rfc5785">[RFC5785]</a>:</p>

  
    <dl>
    
     <dt>URI Suffix
     
    
     <dd>epr-manifest.json
     

    
     <dt>Change controller
     
    
     <dd>W3C
     

    
     <dt>Specification document
     
    
     <dd>This specification (See <a href="#manifest">§3.2 Manifest</a>)
     
  
    </dl>
</section>



   <section>
  
    <h2 class="heading settled" data-level="6" id="acknowledgements"><span class="secno">6. </span><span class="content">Acknowledgements</span><a class="self-link" href="#acknowledgements"></a></h2>


    <p>Awesome people are awesome.</p>
</section>

</main>

  <h2 class="no-ref no-num heading settled" id="conformance"><span class="content">Conformance</span><a class="self-link" href="#conformance"></a></h2>


  <h3 class="no-ref no-num heading settled" id="conventions"><span class="content">Document conventions</span><a class="self-link" href="#conventions"></a></h3>

    
  <p>Conformance requirements are expressed with a combination of
    descriptive assertions and RFC 2119 terminology. The key words "MUST",
    "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT",
    "RECOMMENDED", "MAY", and "OPTIONAL" in the normative parts of this
    document are to be interpreted as described in RFC 2119.
    However, for readability, these words do not appear in all uppercase
    letters in this specification.

    </p>
  <p>All of the text of this specification is normative except sections
    explicitly marked as non-normative, examples, and notes. <a data-link-type="biblio" href="#biblio-rfc2119">[RFC2119]</a></p>

    
  <p>Examples in this specification are introduced with the words "for example"
    or are set apart from the normative text with <code>class="example"</code>,
    like this:

    </p>
  <div class="example">
        
   <p>This is an example of an informative example.</p>
   
    
  </div>

    
  <p>Informative notes begin with the word "Note" and are set apart from the
    normative text with <code>class="note"</code>, like this:

    </p>
  <p class="note" role="note">Note, this is an informative note.</p>


  <h3 class="no-ref no-num heading settled" id="conformant-algorithms"><span class="content">Conformant Algorithms</span><a class="self-link" href="#conformant-algorithms"></a></h3>

    
  <p>Requirements phrased in the imperative as part of algorithms (such as
    "strip any leading space characters" or "return false and abort these
    steps") are to be interpreted with the meaning of the key word ("must",
    "should", "may", etc) used in introducing the algorithm.</p>

    
  <p>Conformance requirements phrased as algorithms or specific steps can be
    implemented in any manner, so long as the end result is equivalent. In
    particular, the algorithms defined in this specification are intended to
    be easy to understand and are not intended to be performant. Implementers
    are encouraged to optimize.</p>


  <h3 class="no-ref no-num heading settled" id="conformance-classes"><span class="content">Conformance Classes</span><a class="self-link" href="#conformance-classes"></a></h3>

    
  <p>A <dfn data-dfn-type="dfn" data-noexport="" id="conformant-user-agent">conformant user agent<a class="self-link" href="#conformant-user-agent"></a></dfn> must implement all the requirements
    listed in this specification that are applicable to user agents.</p>

    
  <p>A <dfn data-dfn-type="dfn" data-noexport="" id="conformant-server">conformant server<a class="self-link" href="#conformant-server"></a></dfn> must implement all the requirements listed
    in this specification that are applicable to servers.</p>




  <h2 class="no-num heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="indexlist">
   <li>allowData, <a href="#dom-eprrule-allowdata">3.2.1</a>
   <li>conformant server, <a href="#conformant-server">Unnumbered section</a>
   <li>conformant user agent, <a href="#conformant-user-agent">Unnumbered section</a>
   <li>contexts, <a href="#dom-eprrule-contexts">3.2.1</a>
   <li>EPR, <a href="#epr-http-response-header-field">3.1</a>
   <li>EPR HTTP response header field, <a href="#epr-http-response-header-field">3.1</a>
   <li>EPR manifest, <a href="#epr-manifest">3.2</a>
   <li>EPRRule, <a href="#dictdef-eprrule">3.2.1</a>
   <li>frameTypes, <a href="#dom-eprrule-frametypes">3.2.1</a>
   <li>match, <a href="#match">4.3</a>
   <li>path, <a href="#dom-eprrule-path">3.2.1</a>
   <li>regex, <a href="#dom-eprrule-regex">3.2.1</a>
   <li>RequestContext, <a href="#enumdef-requestcontext">3.2.1</a>
   <li>RequestFrameType, <a href="#enumdef-requestframetype">3.2.1</a>
   <li>rules, <a href="#rules">3.2.1</a></ul>
  <h3 class="no-num heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="indexlist">
   <li><a data-link-type="biblio" href="#biblio-fetch">[FETCH]</a> defines the following terms:
    <ul>
     <li><a href="https://fetch.spec.whatwg.org/#concept-request-body">body</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-request-context">context</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-request-context-frame-type">context frame type</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-request-client">credentials</a>
     <li><a href="https://fetch.spec.whatwg.org/#fetching">fetching</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-header">header</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-response-header-list">header list</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-request-method">method</a>
     <li><a href="https://fetch.spec.whatwg.org/#process-response">process response</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-request">request</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-response">response</a>
     <li><a href="https://fetch.spec.whatwg.org/#concept-request-url">url</a>
    </ul>
   <li><a data-link-type="biblio" href="#biblio-html5">[HTML5]</a> defines the following terms:
    <ul>
     <li><a href="http://www.w3.org/TR/html5/infrastructure.html#ascii-case-insensitive">ascii case-insensitive match</a>
    </ul>
   <li><a data-link-type="biblio" href="#biblio-mix">[MIX]</a> defines the following terms:
    <ul>
     <li><a href="https://w3c.github.io/webappsec/specs/mixedcontent/#a-priori-insecure-url">a priori insecure</a>
    </ul>
   <li><a data-link-type="biblio" href="#biblio-rfc5234">[RFC5234]</a> defines the following terms:
    <ul>
     <li><a href="https://tools.ietf.org/html/rfc5234#appendix-B.1">wsp</a>
    </ul>
   <li><a data-link-type="biblio" href="#biblio-rfc6454">[RFC6454]</a> defines the following terms:
    <ul>
     <li><a href="https://tools.ietf.org/html/rfc6454#section-3.2">origin</a>
    </ul>
   <li><a data-link-type="biblio" href="#biblio-url">[URL]</a> defines the following terms:
    <ul>
     <li><a href="http://www.w3.org/TR/url/#concept-base-url">base url</a>
     <li><a href="http://www.w3.org/TR/url/#concept-url-fragment">fragment</a>
     <li><a href="http://www.w3.org/TR/url/#concept-url-path">path</a>
     <li><a href="http://www.w3.org/TR/url/#percent-decode">percent decode</a>
     <li><a href="http://www.w3.org/TR/url/#concept-url-query">query</a>
     <li><a href="http://www.w3.org/TR/url/#concept-url-parser">url parser</a>
    </ul>
   <li><a data-link-type="biblio" href="#biblio-webidl2">[WEBIDL2]</a> defines the following terms:
    <ul>
     <li><a href="https://heycam.github.io/webidl/#idl-USVString">USVString</a>
     <li><a href="https://heycam.github.io/webidl/#idl-boolean">boolean</a>
    </ul></ul>
  <h2 class="no-num heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-abnf"><a class="self-link" href="#biblio-abnf"></a>[ABNF]
   <dd>Dave Crocker; Paul Overell. <a href="http://www.ietf.org/rfc/rfc5234.txt">Augmented BNF for Syntax Specifications: ABNF</a>. RFC. URL: <a href="http://www.ietf.org/rfc/rfc5234.txt">http://www.ietf.org/rfc/rfc5234.txt</a>
   <dt id="biblio-fetch"><a class="self-link" href="#biblio-fetch"></a>[FETCH]
   <dd>Anne van Kesteren. <a href="https://fetch.spec.whatwg.org/">Fetch</a>. Living Standard. URL: <a href="https://fetch.spec.whatwg.org/">https://fetch.spec.whatwg.org/</a>
   <dt id="biblio-manifest"><a class="self-link" href="#biblio-manifest"></a>[MANIFEST]
   <dd>Marcos Caceres; Anssi Kostiainen; Kenneth Rohde Christiansen; et al. <a href="http://w3c.github.io/manifest/">Manifest for web application</a>. WD. URL: <a href="http://w3c.github.io/manifest/">http://w3c.github.io/manifest/</a>
   <dt id="biblio-mix"><a class="self-link" href="#biblio-mix"></a>[MIX]
   <dd>Mike West. <a href="https://w3c.github.io/webappsec/specs/mixedcontent/">Mixed Content</a>. LCWD. URL: <a href="https://w3c.github.io/webappsec/specs/mixedcontent/">https://w3c.github.io/webappsec/specs/mixedcontent/</a>
   <dt id="biblio-rfc3864"><a class="self-link" href="#biblio-rfc3864"></a>[RFC3864]
   <dd>Graham Klyne; Mark Nottingham; Jeffrey C. Mogul. <a href="http://www.ietf.org/rfc/rfc3864.txt">Registration Procedures for Message Header Fields</a>. RFC. URL: <a href="http://www.ietf.org/rfc/rfc3864.txt">http://www.ietf.org/rfc/rfc3864.txt</a>
   <dt id="biblio-rfc5785"><a class="self-link" href="#biblio-rfc5785"></a>[RFC5785]
   <dd>Mark Nottingham; Eran Hammer-Lahav. <a href="http://www.ietf.org/rfc/rfc5785.txt">Defining Well-Known Uniform Resource Identifiers (URIs)</a>. RFC. URL: <a href="http://www.ietf.org/rfc/rfc5785.txt">http://www.ietf.org/rfc/rfc5785.txt</a>
   <dt id="biblio-rfc6454"><a class="self-link" href="#biblio-rfc6454"></a>[RFC6454]
   <dd>Adam Barth. <a href="http://www.ietf.org/rfc/rfc6454.txt">The Web Origin Concept</a>. RFC. URL: <a href="http://www.ietf.org/rfc/rfc6454.txt">http://www.ietf.org/rfc/rfc6454.txt</a>
   <dt id="biblio-url"><a class="self-link" href="#biblio-url"></a>[URL]
   <dd>Anne van Kesteren; Sam Ruby. <a href="http://www.w3.org/TR/url">URL</a>. WD. URL: <a href="http://www.w3.org/TR/url">http://www.w3.org/TR/url</a>
   <dt id="biblio-webidl2"><a class="self-link" href="#biblio-webidl2"></a>[WEBIDL2]
   <dd>Cameron McCormack; Boris Zbarsky. <a href="https://heycam.github.io/webidl/">Web IDL (Second Edition)</a>. ED. URL: <a href="https://heycam.github.io/webidl/">https://heycam.github.io/webidl/</a>
   <dt id="biblio-html5"><a class="self-link" href="#biblio-html5"></a>[HTML5]
   <dd>Robin Berjon; et al. <a href="http://www.w3.org/TR/html5/">HTML5</a>. 28 October 2014. REC. URL: <a href="http://www.w3.org/TR/html5/">http://www.w3.org/TR/html5/</a>
   <dt id="biblio-rfc2119"><a class="self-link" href="#biblio-rfc2119"></a>[RFC2119]
   <dd>S. Bradner. <a href="http://www.ietf.org/rfc/rfc2119.txt">Key words for use in RFCs to Indicate Requirement Levels</a>. March 1997. Best Current Practice. URL: <a href="http://www.ietf.org/rfc/rfc2119.txt">http://www.ietf.org/rfc/rfc2119.txt</a>
   <dt id="biblio-rfc5234"><a class="self-link" href="#biblio-rfc5234"></a>[RFC5234]
   <dd>D. Crocker, Ed.; P. Overell. <a href="http://www.ietf.org/rfc/rfc5234.txt">Augmented BNF for Syntax Specifications: ABNF</a>. January 2008. Internet Standard. URL: <a href="http://www.ietf.org/rfc/rfc5234.txt">http://www.ietf.org/rfc/rfc5234.txt</a></dl>
  <h3 class="no-num heading settled" id="informative"><span class="content">Informative References</span><a class="self-link" href="#informative"></a></h3>
  <dl>
   <dt id="biblio-isolation"><a class="self-link" href="#biblio-isolation"></a>[ISOLATION]
   <dd>Eric Y. Chen; et al. <a href="http://www.collinjackson.com/research/papers/appisolation.pdf">App Isolation: Get the Security of Multiple Browsers with Just One</a>. URL: <a href="http://www.collinjackson.com/research/papers/appisolation.pdf">http://www.collinjackson.com/research/papers/appisolation.pdf</a></dl>
  <h2 class="no-num heading settled" id="idl-index"><span class="content">IDL Index</span><a class="self-link" href="#idl-index"></a></h2>
  <pre class="idl">enum <a data-global-name="" href="#enumdef-requestcontext">RequestContext</a> {
    "audio", "beacon", "cspreport", "download", "embed", "eventsource",
    "favicon", "fetch", "font", "form", "frame", "hyperlink", "iframe",
    "image", "imageset", "import", "internal", "location", "manifest",
    "metarefresh", "object", "ping", "plugin", "prefetch", "script",
    "serviceworker", "sharedworker", "subresource", "style", "track",
    "video", "worker", "xmlhttprequest", "xslt"
};

enum <a data-global-name="" href="#enumdef-requestframetype">RequestFrameType</a> {
  "auxiliary", "nested", "none", "top-level"
};

dictionary <a data-global-name="" href="#dictdef-eprrule">EPRRule</a> {
  USVString? <a class="idl-code" data-global-name="EPRRule<dictionary>/path<dict-member>" data-link-type="dict-member" data-type="USVString? " href="#dom-eprrule-path">path</a>;
  USVString? <a class="idl-code" data-global-name="EPRRule<dictionary>/regex<dict-member>" data-link-type="dict-member" data-type="USVString? " href="#dom-eprrule-regex">regex</a>;
  sequence&lt;<a data-link-type="idl-name" href="#enumdef-requestcontext">RequestContext</a>> <a class="idl-code" data-global-name="EPRRule<dictionary>/contexts<dict-member>" data-link-type="dict-member" data-type="sequence<RequestContext> " href="#dom-eprrule-contexts">contexts</a>;
  sequence&lt;<a data-link-type="idl-name" href="#enumdef-requestframetype">RequestFrameType</a>> <a class="idl-code" data-global-name="EPRRule<dictionary>/frameTypes<dict-member>" data-link-type="dict-member" data-type="sequence<RequestFrameType> " href="#dom-eprrule-frametypes">frameTypes</a>;
  boolean <a class="idl-code" data-global-name="EPRRule<dictionary>/allowData<dict-member>" data-link-type="dict-member" data-type="boolean " href="#dom-eprrule-allowdata">allowData</a>;
};

</pre>
  <h2 class="no-num heading settled" id="issues-index"><span class="content">Issues Index</span><a class="self-link" href="#issues-index"></a></h2>
  <div style="counter-reset:issue">
   <div class="issue">Why is this distinct from <a data-link-type="biblio" href="#biblio-manifest">[MANIFEST]</a>? I think we could do pretty
  much everything by adding an <code>erp_rules</code> attribute. Since we’ve
  already accepted the asynchronocity, duplicating the manifest doesn’t seem
  prudent.<a href="#issue-3b30c111"> ↵ </a></div>
   <div class="issue">The example manifest defines <code>site</code>. Do we really need
    that, given that we know the manifest’s URL?<a href="#issue-6332bbe9"> ↵ </a></div>
   <div class="issue">The example manifest defines <code>maxAge</code>. Do we need that,
    or can we rely on cache headers?<a href="#issue-1122723a"> ↵ </a></div>
   <div class="issue">The example manifest defines <code>reportUrl</code>. What does this
    report? What do the reports look like? Do we need it at all?<a href="#issue-2a78bb3d"> ↵ </a></div>
   <div class="issue">The example manifest defines <code>defaultNavBehavior</code>. What
    does this do?<a href="#issue-ef156df8"> ↵ </a></div>
   <div class="issue">The example manifest defines <code>defaultResBehavior</code>. What
    does this do?<a href="#issue-28b78586"> ↵ </a></div>
   <div class="issue">When do we <a data-link-type="dfn" href="http://www.w3.org/TR/url/#percent-decode">percent decode</a>?<a href="#issue-b0f6b6d6"> ↵ </a></div>
   <div class="issue">Is there a use case for delivering different manifests to
          different users? I’d hope not.<a href="#issue-f19006b1"> ↵ </a></div>
   <div class="issue">Need to have spec language for this. There’s surely a regex
          spec somewhere, right?<a href="#issue-e1f6f36f"> ↵ </a></div></div></body>
</html>